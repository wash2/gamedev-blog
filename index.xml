<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Gamedev Blog</title><link>https://micah.ash.gay/</link><description>Recent content on Gamedev Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 09 Oct 2021 01:00:00 +0200</lastBuildDate><atom:link href="https://micah.ash.gay/index.xml" rel="self" type="application/rss+xml"/><item><title>Deploying Nakama</title><link>https://micah.ash.gay/p/nakama-arm/</link><pubDate>Sat, 09 Oct 2021 01:00:00 +0200</pubDate><guid>https://micah.ash.gay/p/nakama-arm/</guid><description>&lt;img src="https://micah.ash.gay/p/nakama-arm/cover.jpg" alt="Featured image of post Deploying Nakama" />&lt;p>This article was inspired by an article on the Oracle dev blog about &lt;a class="link" href="https://blogs.oracle.com/developers/post/how-to-set-up-and-run-a-really-powerful-free-minecraft-server-in-the-cloud" target="_blank" rel="noopener"
>setting up a free Minecraft server&lt;/a> :)&lt;/p>
&lt;p>Create your free Oracle Cloud Account &lt;a class="link" href="https://www.oracle.com/cloud/free/" target="_blank" rel="noopener"
>here&lt;/a> to get started! It may take a few days for the account to be confirmed. I eventually received a phone call confirming my account and was able to get started after that.&lt;/p>
&lt;h2 id="creating-an-always-free-vm">Creating an Always Free VM&lt;/h2>
&lt;p>Much of this section is &amp;ldquo;borrowed&amp;rdquo; from the Minecraft article on the Oracle dev blog.&lt;/p>
&lt;p>Log into your free account and get started by Creating a VM instance.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 192;
flex-basis: 460px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/create-vm.png" data-size="912x475">
&lt;img src="https://micah.ash.gay/p/nakama-arm/create-vm.png"
width="912"
height="475"
srcset="https://micah.ash.gay/p/nakama-arm/create-vm_hu2d8fd3dacb8c7152c918e418f23dfabc_68703_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/create-vm_hu2d8fd3dacb8c7152c918e418f23dfabc_68703_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="create-vm">
&lt;/a>
&lt;figcaption>create-vm&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Give your VM instance a name (the example from Oracle is “minecraft-server&amp;quot;) and choose a “compartment”. Compartments are just a way to group different things together. You can just leave the default (“root”) compartment selected.&lt;/p>
&lt;p>Also, choose an “availability domain”, preferably one close to where you are geographically - but, it shouldn&amp;rsquo;t matter too much. (You may need to change the availability domain if you can&amp;rsquo;t find the Ampere Arm shape)&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 141;
flex-basis: 340px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/availability-domain.png" data-size="792x559">
&lt;img src="https://micah.ash.gay/p/nakama-arm/availability-domain.png"
width="792"
height="559"
srcset="https://micah.ash.gay/p/nakama-arm/availability-domain_hu3a229febe353e616bd7bff5ec257ea56_60563_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/availability-domain_hu3a229febe353e616bd7bff5ec257ea56_60563_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="availability-domain">
&lt;/a>
&lt;figcaption>availability-domain&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Next, find the Image and Shape section, select Oracle Linux 8.4 and then click &amp;ldquo;change shape&amp;rdquo;&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 149;
flex-basis: 359px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/shape.png" data-size="789x527">
&lt;img src="https://micah.ash.gay/p/nakama-arm/shape.png"
width="789"
height="527"
srcset="https://micah.ash.gay/p/nakama-arm/shape_hu978e1af3bda68e03606018227f8ced2e_57859_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/shape_hu978e1af3bda68e03606018227f8ced2e_57859_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="shape">
&lt;/a>
&lt;figcaption>shape&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>In the shape dialog, select the &amp;lsquo;Instance type&amp;rsquo; of ‘Virtual Machine’ and then select ‘Ampere’ (ARM) under ’Shape series’. Choose the ‘VM.Standard.A1.Flex’ shape and choose the amount of CPU and RAM that you want to allocate to this server. For your “always free” ARM servers, you get up to 4 OCPU and 24 GB of RAM to allocate. This means that you can turn up one virtual machine with 4 OCPU and 24GB of RAM, or 4 servers each with 1 OCPU and 6GB of RAM (or any combination up to the limit).&lt;/p>
&lt;p>For the sake of this tutorial you can create your virtual machine with 4 OCPU and 24GB of RAM.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 134;
flex-basis: 322px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/selecting-arm.png" data-size="881x656">
&lt;img src="https://micah.ash.gay/p/nakama-arm/selecting-arm.png"
width="881"
height="656"
srcset="https://micah.ash.gay/p/nakama-arm/selecting-arm_hu2b12d887ed815d4c497744c149aa436d_100961_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/selecting-arm_hu2b12d887ed815d4c497744c149aa436d_100961_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="selecting-arm">
&lt;/a>
&lt;figcaption>selecting-arm&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Double check that the Always Free Eligible tag is visible for your selected shape.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 200;
flex-basis: 480px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/always-free-indicator.png" data-size="757x378">
&lt;img src="https://micah.ash.gay/p/nakama-arm/always-free-indicator.png"
width="757"
height="378"
srcset="https://micah.ash.gay/p/nakama-arm/always-free-indicator_hu0776b65d8a45c8972de37feac3ec130c_40886_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/always-free-indicator_hu0776b65d8a45c8972de37feac3ec130c_40886_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="always-free-indicator">
&lt;/a>
&lt;figcaption>always-free-indicator&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Next, we’ll need to choose a virtual cloud network (VCN). If you already have an existing VCN with a public subnet, choose that. If not, select ‘Create a new virtual cloud network’. Then, choose ‘Create a public subnet’ and accept the default names. Finally, make sure that ‘Assign a public IPv4 address’ is selected (otherwise you couldn’t connect to this server from the internet!).&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 118;
flex-basis: 283px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/vcn.png" data-size="766x649">
&lt;img src="https://micah.ash.gay/p/nakama-arm/vcn.png"
width="766"
height="649"
srcset="https://micah.ash.gay/p/nakama-arm/vcn_hu33083279203848134981fc4e906fd296_90252_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/vcn_hu33083279203848134981fc4e906fd296_90252_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="vcn">
&lt;/a>
&lt;figcaption>vcn&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Now we need to associate an “SSH” key pair with this VM. If you’re familiar with this concept and already have a public key that you want to use, choose ‘Upload public key files’ and upload your public key. If you’re not familiar with this, think of these keys as a unique set of identifiers that allow you to securely log in to your server. Click ‘Generate SSH key pair’ and save your private and public keys to your local machine. We’ll use these in just a bit to log in to the VM.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 240;
flex-basis: 577px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/ssh-key-upload-or-creation.png" data-size="791x329">
&lt;img src="https://micah.ash.gay/p/nakama-arm/ssh-key-upload-or-creation.png"
width="791"
height="329"
srcset="https://micah.ash.gay/p/nakama-arm/ssh-key-upload-or-creation_hu6dc785744a8067c5622820ca74ad6ac1_48368_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/ssh-key-upload-or-creation_hu6dc785744a8067c5622820ca74ad6ac1_48368_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ssh-key-upload-or-creation">
&lt;/a>
&lt;figcaption>ssh-key-upload-or-creation&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Finally click &amp;ldquo;Create&amp;rdquo; and you will be redirected to the VM details page. In a few minutes, your VM will be up and running. Take note of your public IP!&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 222;
flex-basis: 534px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/public-ip.png" data-size="899x404">
&lt;img src="https://micah.ash.gay/p/nakama-arm/public-ip.png"
width="899"
height="404"
srcset="https://micah.ash.gay/p/nakama-arm/public-ip_hub9f70d640ba199cbbd80199eb17b53fa_62693_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/public-ip_hub9f70d640ba199cbbd80199eb17b53fa_62693_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="public-ip">
&lt;/a>
&lt;figcaption>public-ip&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>Finally connect to your VM using SSH. It may take a couple more minutes after the VM has started to accept the connection, so be patient.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 621;
flex-basis: 1490px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/connect-to-vm.png" data-size="677x109">
&lt;img src="https://micah.ash.gay/p/nakama-arm/connect-to-vm.png"
width="677"
height="109"
srcset="https://micah.ash.gay/p/nakama-arm/connect-to-vm_hu00e005738c0388cc61b4354a67e0574d_27214_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/connect-to-vm_hu00e005738c0388cc61b4354a67e0574d_27214_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="connect-to-vm">
&lt;/a>
&lt;figcaption>connect-to-vm&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;h2 id="installing-docker-packages">Installing Docker packages&lt;/h2>
&lt;p>You may need to run the following commands with sudo..&lt;/p>
&lt;p>Install Docker:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">sudo dnf install -y dnf-utils zip unzip
sudo dnf config-manager --add-repo&lt;span class="o">=&lt;/span>https://download.docker.com/linux/centos/docker-ce.repo
sudo dnf remove -y runc
sudo dnf install -y docker-ce --nobest
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Start the docker service now and enable it so it runs on boot:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">sudo systemctl &lt;span class="nb">enable&lt;/span> docker.service --now
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Check the status of the docker service:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">systemctl status docker.service
sudo docker info
sudo docker version
&lt;/code>&lt;/pre>&lt;/div>&lt;p>run hello world!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">sudo docker run hello-world
sudo docker images hello-world
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Create the docker group. The docker group will give members the privelege to run docker commands without sudo. This is equivalent to having priveleges of the root user, but will be necessary for the next step.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">sudo groupadd docker
sudo usermod -aG docker &lt;span class="nv">$USER&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Restart the VM and reconnect&lt;/p>
&lt;p>run hello world again without sudo!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">docker run hello-world
docker images hello-world
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finally install Docker Compose: following the instructions at the &lt;a class="link" href="https://github.com/docker/compose" target="_blank" rel="noopener"
>Github Repo&lt;/a>. (The docker site instructions are out of date for Linux install)&lt;/p>
&lt;h2 id="getting-nakama-docker-compose-configs">Getting Nakama Docker Compose Configs&lt;/h2>
&lt;p>Familiarize yourself with Nakama deployment basics at their &lt;a class="link" href="https://heroiclabs.com/docs/nakama/getting-started/docker-quickstart/" target="_blank" rel="noopener"
>site&lt;/a>.&lt;/p>
&lt;p>Create a nakama directory to hold the files in your $HOME directory.&lt;/p>
&lt;pre tabindex="0">&lt;code>[opc@ashtronaut-vm nakama]$ pwd
/home/opc/nakama
[opc@ashtronaut-vm nakama]$ ls docker-compose.yml
docker-compose.yml
&lt;/code>&lt;/pre>&lt;p>Try running &lt;code>docker compose up&lt;/code>. It will fail because you need to make some changes to the docker-compose.yml that they provide in order to run on Arm. Not only that, but Nakama does not provide an ARM image, but since it is Open Source, their Dockerfile is available in the public repo, and we can build our own!&lt;/p>
&lt;h2 id="necessary-config-changes">Necessary Config Changes&lt;/h2>
&lt;p>Change the &lt;a class="link" href="https://hub.docker.com/r/christoofar/cockroachdb-arm64" target="_blank" rel="noopener"
>cockroachDB image&lt;/a>. Note that you could also build your own, but at the time of writing, this is a fairly recent build.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="c"># /home/opc/nakama/docker-compose.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">cockroachdb&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">christoofar/cockroachdb-arm64&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Change the &lt;a class="link" href="https://hub.docker.com/r/prom/prometheus-linux-arm64" target="_blank" rel="noopener"
>Prometheus image&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="c"># /home/opc/nakama/docker-compose.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">prometheus&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">christoofar/cockroachdb-arm64&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Build your own Nakama image!
Clone the &lt;a class="link" href="https://github.com/heroiclabs/nakama" target="_blank" rel="noopener"
>Nakama public repository&lt;/a> into the your current directory. &lt;code>pwd&lt;/code> should show as /home/opc/nakama/nakama/build.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">git clone https://github.com/heroiclabs/nakama.git
&lt;span class="nb">cd&lt;/span> nakama/build
&lt;span class="nb">pwd&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>edit build/Dockerfile. Find the line with &lt;code>ENV GOARCH amd64&lt;/code> and change the value to &lt;code>ENV GOARCH arm64&lt;/code>. Next run the build with the latest release version.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">docker build &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$PWD&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> --build-arg &lt;span class="nv">commit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>git rev-parse --short HEAD&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> --build-arg &lt;span class="nv">version&lt;/span>&lt;span class="o">=&lt;/span>v3.2.1 -t heroiclabs/nakama:3.2.1-arm64
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finally edit your docker-compose to use your new docker image! It will already be stored with docker.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="c"># /home/opc/nakama/docker-compose.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">nakama&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">heroiclabs/nakama:3.2.1-arm64&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>After you can successfully run &lt;code>docker compose up&lt;/code>, Try replacing the default security keys and passwords values using a config like provided &lt;a class="link" href="https://heroiclabs.com/docs/nakama/getting-started/docker-quickstart/#configuration-file" target="_blank" rel="noopener"
>here&lt;/a> also see &lt;a class="link" href="https://heroiclabs.com/docs/nakama/getting-started/docker-quickstart/#configuration-file" target="_blank" rel="noopener"
>https://heroiclabs.com/docs/nakama/getting-started/docker-quickstart/#configuration-file&lt;/a> for reference.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="c"># /home/opc/nakama/docker-compose.yml&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">services&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="c"># ...&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">nakama&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">image&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">heroiclabs/nakama:3.2.1-arm64&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">entrypoint&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;/bin/sh&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="s2">&amp;#34;-ecx&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="p">&amp;gt;&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> /nakama/nakama migrate up --database.address root@cockroachdb:26257 &amp;amp;&amp;amp;
&lt;/span>&lt;span class="sd"> exec /nakama/nakama --config /nakama/data/full-config.yml --database.address root@cockroachdb:26257 --logger.level DEBUG --session.token_expiry_sec 7200 --metrics.prometheus_port 9100&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="run-on-boot-via-systemd">Run on Boot via Systemd&lt;/h2>
&lt;p>Write a systemd service file that will run your docker compose script on boot!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-ini" data-lang="ini">&lt;span class="c1"># /etc/systemd/system/docker-compose-app.service&lt;/span>
&lt;span class="k">[Unit]&lt;/span>
&lt;span class="na">Description&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">Docker Compose Application Service&lt;/span>
&lt;span class="na">Requires&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">docker.service&lt;/span>
&lt;span class="na">After&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">docker.service&lt;/span>
&lt;span class="k">[Service]&lt;/span>
&lt;span class="na">Type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">oneshot&lt;/span>
&lt;span class="na">RemainAfterExit&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">yes&lt;/span>
&lt;span class="na">User&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">opc&lt;/span>
&lt;span class="na">WorkingDirectory&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/home/opc/nakama/&lt;/span>
&lt;span class="na">ExecStart&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/usr/bin/docker compose up -d&lt;/span>
&lt;span class="na">ExecStop&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">/usr/bin/docker compose down&lt;/span>
&lt;span class="na">TimeoutStartSec&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">0&lt;/span>
&lt;span class="k">[Install]&lt;/span>
&lt;span class="na">WantedBy&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">multi-user.target&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>enable the service to run on boot!&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">sudo systemctl &lt;span class="nb">enable&lt;/span> docker-compose-app
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Restart your VM and check the status of your service:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">systemctl status docker-compose-app
&lt;span class="c1"># view logs&lt;/span>
journalctl -xeu docker-compose-app
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="setting-up-vcn-firewall-rules">Setting up VCN Firewall Rules&lt;/h2>
&lt;p>Finally return to the Oracle Cloud dashboard and navigate to your VM details page. Click on the VCN subnet then select the security list and you will be taken to the correct page for adding ingress and egress rules. These will allow data to flow in and out of your VM.
Create ingress and egress rules for the ports that you specified in your configuration. I will just add TCP rules, but if you plan on using UDP you should add rules for those as well.&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 187;
flex-basis: 450px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/ingress.png" data-size="925x493">
&lt;img src="https://micah.ash.gay/p/nakama-arm/ingress.png"
width="925"
height="493"
srcset="https://micah.ash.gay/p/nakama-arm/ingress_huc9bcb02f8d7245a22d6e12fad7cec776_38882_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/ingress_huc9bcb02f8d7245a22d6e12fad7cec776_38882_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="ingress">
&lt;/a>
&lt;figcaption>ingress&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>&lt;figure
class="gallery-image"
style="
flex-grow: 187;
flex-basis: 450px"
>
&lt;a href="https://micah.ash.gay/p/nakama-arm/egress.png" data-size="925x493">
&lt;img src="https://micah.ash.gay/p/nakama-arm/egress.png"
width="925"
height="493"
srcset="https://micah.ash.gay/p/nakama-arm/egress_hu08c1a12e0392390c31f063214c535e2c_38787_480x0_resize_box_3.png 480w, https://micah.ash.gay/p/nakama-arm/egress_hu08c1a12e0392390c31f063214c535e2c_38787_1024x0_resize_box_3.png 1024w"
loading="lazy"
alt="egress">
&lt;/a>
&lt;figcaption>egress&lt;/figcaption>
&lt;/figure>&lt;/p>
&lt;p>That&amp;rsquo;s it, you&amp;rsquo;re done! Try following &lt;a class="link" href="https://heroiclabs.com/blog/tutorials/godot-fishgame/" target="_blank" rel="noopener"
>https://heroiclabs.com/blog/tutorials/godot-fishgame/&lt;/a> and use your public IP and your secret key when working through the tutorial. Try sharing a lobby with a friend :)&lt;/p>
&lt;h2 id="future-goals">Future Goals&lt;/h2>
&lt;p>There is so much more that can be done with Nakama. You can proxy the server, for example. And it is intended to be run as a cluster. A future post could demonstrate the steps for deploying an auto-scaling cluster on AWS, GCP, or Oracle Cloud! For now I am just doing simple development and testing, so the free Oracle VM will be suitable for me :)&lt;/p></description></item></channel></rss>